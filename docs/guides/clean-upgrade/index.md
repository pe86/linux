# Καθαρή αναβάθμιση

Προτείνουμε μία μέθοδο αναβάθμισης του Ubuntu που χρησιμοποιεί καθαρές
εγκαταστάσεις κάθε φορά, και η οποία εκτός από το πλεονέκτημα των φρέσκων
ρυθμίσεων, έχει και το πλεονέκτημα ότι η παλιά εγκατάσταση είναι διαθέσιμη μαζί
με την καινούργια. Ανάλογα με τις κατατμήσεις σας, είτε μπορείτε να τις
χρησιμοποιείτε εντελώς παράλληλα, είτε να επαναφέρετε την παλιά σε πολύ μικρό
χρονικό διάστημα. Αυτό βολεύει και σαν backup λειτουργικό στην περίπτωση που η
νέα εγκατάσταση έχει κάποιο πρόβλημα. Για παράδειγμα, αν διαπιστώσετε ότι η
νέα σας εγκατάσταση 24.04 δεν δουλεύει με τους clients σας, ή αν καταστράφηκε
λόγω κάποιου σοβαρού προβλήματος, μπορείτε σε λίγα λεπτά να επαναφέρετε την
παλιότερη π.χ. 22.04 και να συνεχίσετε το μάθημα.

Τα μειονεκτήματα των καθαρών εγκαταστάσεων είναι ο επιπλέον φόρτος για την
ρύθμιση του συστήματος εξ' αρχής (αν και τα sch-scripts βοηθάνε αρκετά στην
αυτοματοποίηση των ρυθμίσεων) και ο επιπλέον χώρος που χρειάζονται στο δίσκο.

## Προτεινόμενες κατατμήσεις

Εάν έχετε αρκετό χώρο στο δίσκο, προτείνεται να έχετε τα παρακάτω 4 partitions
για το Linux. Εάν χρειάζεστε και Windows, βάλτε τα όλα σε ένα extended
partition, γιατί primary partitions επιτρέπονται μόνο ως 4.

- Παλιά εγκατάσταση, π.χ. sda1 = 100 Gb
- Νέα εγκατάσταση, π.χ. sda2 = 100 Gb
- Κοινό /home για τα αρχεία των χρηστών, π.χ. sda3 = 200 Gb
- Προαιρετικό swap partition, π.χ. sda4 = 4 Gb

## Μετακίνηση της παλιάς εγκατάστασης σε υποφάκελο

Εάν **δεν** έχετε χωριστό partition για την παλιά εγκατάσταση, με τις παρακάτω
ενέργειες μπορείτε να την κρατήσετε σε ένα φάκελο, ώστε να μπορείτε γρήγορα να
την επαναφέρετε σε περίπτωση προβλήματος, ή για να έχετε πρόσβαση σε παλιά
αρχεία ρυθμίσεων (π.χ. ltsp.conf) που μπορεί να θυμηθείτε στην πορεία ότι τα
χρειάζεστε.

Αφού ξεκινήσετε με το live CD της 24.04, επιλέξτε ***Κάτι άλλο***, και πριν
ξεκινήσετε την εγκατάσταση, ανοίξτε ένα τερματικό με και δώστε τις παρακάτω
εντολές:


```shell
sudo -i

# Προβολή των κατατμήσεων, ας πούμε ότι το Ubuntu είναι στο sda1.
blkid

# Προσάρτηση του παλιού λειτουργικού.
mount /dev/sda1 /mnt

# Μετακίνηση των αρχείων του παλιού λειτουργικού στο φάκελο srv/old-ubuntu
# Διαλέγουμε συγκεκριμένα το srv επειδή αυτός δεν συμπεριλαμβάνεται
# κατά τη δημοσίευση εικονικού δίσκου, αλλιώς ο εικονικός δίσκος του
# LTSP θα ήταν τεράστιος.
mkdir /mnt/srv/old-ubuntu
find /mnt/ -mindepth 1 -maxdepth 1 ! -name home ! -name srv -exec mv {} /mnt/srv/old-ubuntu/ \;

# Αποπροσάρτηση του παλιού λειτουργικού
umount /mnt
exit
```

Στη συνέχεια ξεκινήστε την εγκατάσταση και στο διάλογο ρύθμισης των
κατατμήσεων, επιλέξτε , και ορίστε ότι το sda1 θα χρησιμοποιηθεί
ως/χωρίς διαμόρφωση. Θα βγει αργότερα μια προειδοποίηση ότι εάν
υπάρχουν φάκελοι /var, /lib, /usr κτλ θα διαγραφούν, αγνοήστε τη,
τους έχουμε μεταφέρει στο /srv/old-ubuntu.

## Λογαριασμοί χρηστών

Για να μεταφέρετε τους παλιούς λογαριασμούς χρηστών στη νέα εγκατάσταση, ή για
να δημιουργήσετε νέους λογαριασμούς, ακολουθήστε τις οδηγίες της ενότητας
[Λογαριασμοί χρηστών](../../ltsp/users.md).
